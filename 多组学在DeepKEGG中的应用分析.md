# 多组学在 DeepKEGG 中的应用

## 多组学的含义

在 DeepKEGG 论文中，"多组学"（multi-omics）指的是整合多种生物学数据类型（或称为"组学数据"）进行综合分析的方法。通过整合不同层次的分子数据，可以获得比单一数据类型更全面的生物学见解。

## DeepKEGG 框架中使用的多组学数据类型

DeepKEGG 框架整合了以下三种组学数据：

1. **基因突变数据（SNV data）**：单核苷酸变异数据，反映基因组层面的变化
2. **mRNA 表达数据**：反映转录组层面的基因表达情况
3. **miRNA 表达数据**：微小 RNA 数据，这些是非编码 RNA，在基因表达调控中起重要作用

## 数据集特点

该研究使用了多种癌症数据集进行分析：

- BLCA（膀胱癌）
- LIHC（肝癌）
- PRAD（前列腺癌）
- BRCA（乳腺癌）
- AML（急性髓系白血病）

以 BLCA 数据集为例，其包含：

- 402 个样本
- 1000 个 SNV 特征
- 1000 个 mRNA 特征
- 100 个 miRNA 特征

## 多组学数据整合方法

DeepKEGG 采用了创新的方法整合这些多组学数据：

1. **基于 KEGG 通路的生物学先验知识**：利用 KEGG（京都基因与基因组百科全书）通路信息，将基因和 miRNA 映射到相关生物通路上
2. **生物学模块设计**：通过 Biological_module 层将高维的组学数据降维到 238 个通路特征上，大大减轻了"维度灾难"问题
3. **自注意力机制**：使用 Self_Attention 模块学习不同样本在通路特征空间中的相关性特征，增强模型的鲁棒性
4. **多组学特征融合**：通过 concatenate 层将三种组学数据的特征连接起来，进行综合分析

## 应用目标

这个多组学数据整合框架主要用于：

1. 癌症复发预测
2. 生物标志物发现

通过计算生物节点（基因、通路等）的贡献分数，DeepKEGG 能够揭示基因、通路和癌症之间的调控关系，从而识别潜在的生物标志物。

## 模型优势

1. 通过引入生物学先验知识解决了高维多组学数据整合的挑战
2. 通过通路自注意力模块提高了模型的鲁棒性
3. 能够提供生物学可解释性，揭示基因和通路与疾病的关系

总之，这篇论文中的多组学整合方法结合了现代深度学习技术和生物学先验知识，为癌症复发预测和生物标志物发现提供了一个有效的计算框架。

Q: 这个通路数量是人为确定的嘛？ mRNA 和 miRNA 有相同的通路？

A: 通路数量不是人为确定的，而是基于 KEGG 数据库中已有的生物通路信息。这个通路数量是由 pathway_union = list(paways_genes_dicts.keys())确定的，共有 238 个通路。

关于 mRNA 和 miRNA 是否有相同的通路：

是的，mRNA 和 miRNA 共享相同的通路集合。在代码中可以看到，对所有组学数据（包括 mRNA 和 miRNA）使用了同一个 pathway_union 变量。这表明所有组学数据都被映射到相同的 238 个 KEGG 通路上。

但它们与通路的关联方式有所不同：\* mRNA（基因）是通路的组成部分，它们编码的蛋白质直接参与通路中的生物过程

- miRNA 通常是通路的调控者，它们通过调控基因表达间接影响通路活性

这也解释了为什么代码中使用了两个不同的字典：\* paways_genes_dicts：存储通路与基因的对应关系

- paways_mirna_dicts：存储通路与 miRNA 的对应关系

尽管 mRNA 和 miRNA 与通路的生物学关系不同，但 DeepKEGG 模型将它们映射到相同的通路特征空间，使得不同组学数据可以在通路层面进行整合分析。这也是多组学整合的核心思想之一：将不同类型的分子数据转换到同一个生物学意义空间中进行联合分析。

通路数量不是人为确定的，而是基于 KEGG 数据库中已有的生物通路信息。这个通路数量是由 pathway_union = list(paways_genes_dicts.keys())确定的，共有 238 个通路。

关于 mRNA 和 miRNA 是否有相同的通路：

是的，mRNA 和 miRNA 共享相同的通路集合。在代码中可以看到，对所有组学数据（包括 mRNA 和 miRNA）使用了同一个 pathway_union 变量。这表明所有组学数据都被映射到相同的 238 个 KEGG 通路上。

但它们与通路的关联方式有所不同：\* mRNA（基因）是通路的组成部分，它们编码的蛋白质直接参与通路中的生物过程

- miRNA 通常是通路的调控者，它们通过调控基因表达间接影响通路活性

这也解释了为什么代码中使用了两个不同的字典：\* paways_genes_dicts：存储通路与基因的对应关系

- paways_mirna_dicts：存储通路与 miRNA 的对应关系

尽管 mRNA 和 miRNA 与通路的生物学关系不同，但 DeepKEGG 模型将它们映射到相同的通路特征空间，使得不同组学数据可以在通路层面进行整合分析。这也是多组学整合的核心思想之一：将不同类型的分子数据转换到同一个生物学意义空间中进行联合分析。

通路数量不是人为确定的，而是基于 KEGG 数据库中已有的生物通路信息。这个通路数量是由 pathway_union = list(paways_genes_dicts.keys())确定的，共有 238 个通路。

关于 mRNA 和 miRNA 是否有相同的通路：

是的，mRNA 和 miRNA 共享相同的通路集合。在代码中可以看到，对所有组学数据（包括 mRNA 和 miRNA）使用了同一个 pathway_union 变量。这表明所有组学数据都被映射到相同的 238 个 KEGG 通路上。

但它们与通路的关联方式有所不同：\* mRNA（基因）是通路的组成部分，它们编码的蛋白质直接参与通路中的生物过程

- miRNA 通常是通路的调控者，它们通过调控基因表达间接影响通路活性

这也解释了为什么代码中使用了两个不同的字典：\* paways_genes_dicts：存储通路与基因的对应关系

- paways_mirna_dicts：存储通路与 miRNA 的对应关系

尽管 mRNA 和 miRNA 与通路的生物学关系不同，但 DeepKEGG 模型将它们映射到相同的通路特征空间，使得不同组学数据可以在通路层面进行整合分析。这也是多组学整合的核心思想之一：将不同类型的分子数据转换到同一个生物学意义空间中进行联合分析。

通路数量不是人为确定的，而是基于 KEGG 数据库中已有的生物通路信息。这个通路数量是由 pathway_union = list(paways_genes_dicts.keys())确定的，共有 238 个通路。

关于 mRNA 和 miRNA 是否有相同的通路：

是的，mRNA 和 miRNA 共享相同的通路集合。在代码中可以看到，对所有组学数据（包括 mRNA 和 miRNA）使用了同一个 pathway_union 变量。这表明所有组学数据都被映射到相同的 238 个 KEGG 通路上。

但它们与通路的关联方式有所不同：\* mRNA（基因）是通路的组成部分，它们编码的蛋白质直接参与通路中的生物过程

- miRNA 通常是通路的调控者，它们通过调控基因表达间接影响通路活性

这也解释了为什么代码中使用了两个不同的字典：\* paways_genes_dicts：存储通路与基因的对应关系

- paways_mirna_dicts：存储通路与 miRNA 的对应关系

尽管 mRNA 和 miRNA 与通路的生物学关系不同，但 DeepKEGG 模型将它们映射到相同的通路特征空间，使得不同组学数据可以在通路层面进行整合分析。这也是多组学整合的核心思想之一：将不同类型的分子数据转换到同一个生物学意义空间中进行联合分析。

这个图展示了 6 个 mRNA 基因在肝癌(LIHC)患者中的生存分析结果。每个子图(A-F)显示了不同基因的 Kaplan-Meier 生存曲线：

图中，患者被基于特定基因的表达水平分为高风险组(High risk，红色)和低风险组(Low risk，蓝色)。纵轴代表生存概率，横轴代表时间(年)。图中的 p 值表明这些分组在统计学上有显著差异。

具体来看：1. 图 A：CD8A 基因 - 高表达组生存率较高(p=0.002)

1. 图 B：CDC25B 基因 - 低表达组生存率较高(p<0.001)
2. 图 C：ACACA 基因 - 低表达组生存率较高(p=0.007)
3. 图 D：PIK3R2 基因 - 低表达组生存率较高(p=0.006)
4. 图 E：IPMK 基因 - 低表达组生存率较高(p=0.005)
5. 图 F：EFNA3 基因 - 低表达组生存率较高(p<0.001)

图的下方显示了每个时间点各组剩余患者数量。这些结果表明，这些基因的表达水平可能是肝癌预后的潜在生物标志物，特别是对于那些 p 值非常显著的基因(如 CDC25B 和 EFNA3)。

这些发现可能来自于 DeepKEGG 模型的可解释性分析，揭示了对癌症复发预测贡献最大的关键基因。这正是论文中所描述的模型可解释性模块的重要应用。

1. paways_genes_dict 字典：

- 这是基因-通路的对应关系字典
- 键(key)：KEGG 通路 ID，如'hsa00010'（hsa 代表人类，00010 是通路编号）
- 值(value)：该通路包含的基因列表
- 数据来源：'20230205_kegg_hsa.gmt'文件
- 示例：从代码输出可以看到'hsa00010'这个通路包含了['ACSS1', 'ACSS2', 'ADH1A'...]等基因

1. paways_mirna_dict 字典：

- 这是 miRNA-通路的对应关系字典
- 键(key)：同样是 KEGG 通路 ID
- 值(value)：该通路相关的 microRNA 列表
- 数据来源：'kegg_anano.txt'文件
- 处理过程中使用了 set()去重，确保每个 miRNA 只出现一次

简单来说：\* paways_genes_dict 告诉我们"每个通路包含哪些基因"

- paways_mirna_dict 告诉我们"每个通路与哪些 microRNA 相关"
